{% extends 'base.html' %}

{% block content %}
    <div class="container mt-4">
        
        <div class="d-flex justify-content-end mt-5">
            <form method="post" class="mb-4">
                <h3>–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ Excel</h3>
                {% csrf_token %}
                {{ form.as_p }}
                <h6>* –£—á–∏—Ç—ã–≤–∞–π—Ç–µ, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–æ–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –æ–±–Ω–æ–≤—è—Ç—Å—è</h6>
                <button type="submit" class="btn btn-success">–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤ Excel</button>
            </form>
        </div>    

        
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>–°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h1>
            <div class="d-flex justify-content-end">
                <a href="{% url 'users:create_student' %}" class="btn btn-primary ms-5">–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞</a>    
            </div>
        </div>
        
        <table class="table table-bordered">
            <thead class="table-light">
                <tr>
                    <th>–õ–æ–≥–∏–Ω</th>  
                    <th>–§–∞–º–∏–ª–∏—è</th>
                    <th>–ò–º—è</th>
                    <th>–ì—Ä—É–ø–ø–∞</th>
                    <th>–ì–æ–¥</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for student in students %}
                    {% for group in student.groups.all %}
                        <tr>
                            {% if forloop.first %}
                                <td rowspan="{{ student.groups.count }}" class="align-middle">{{ student.username }}</td>
                                <td rowspan="{{ student.groups.count }}" class="align-middle">{{ student.last_name }}</td>
                                <td rowspan="{{ student.groups.count }}" class="align-middle">{{ student.first_name }}</td>
                            {% endif %}
                            <td>{{ group.number }}</td>
                            <td>{{ group.year }}</td>
                            <td>
                                <a href="{% url 'users:delete_student' student.id %}">üóëÔ∏è</a>
                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td>{{ student.username }}</td>
                            <td>{{ student.last_name }}</td>
                            <td>{{ student.first_name }}</td>
                            <td colspan="2" class="text-muted text-center">–ù–µ—Ç –≥—Ä—É–ø–ø—ã</td>
                        </tr>
                    {% endfor %}
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}

