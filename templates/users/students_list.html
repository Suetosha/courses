{% extends 'base.html' %}

{% block content %}
    <div class="container mt-4">
        
        <div class="d-flex flex-column align-items-end mt-5">
            
            <form method="post" class="mb-4 d-flex flex-column">
                <h3 class="mb-2">–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ Excel</h3>
                {% csrf_token %}
                {{ group_form.as_p }}
                <h6>* –£—á–∏—Ç—ã–≤–∞–π—Ç–µ, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ä–æ–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –æ–±–Ω–æ–≤—è—Ç—Å—è</h6>
                <button type="submit" class="btn btn-success mt-2">–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
            </form>
            
            <form method="post" enctype="multipart/form-data" class="mb-4 mt-5 d-flex flex-column">
                <h3>–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ Excel</h3>
                {% csrf_token %}
                <div class="form-group">
                    <label for="excel_file">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</label>
                    <input type="file" name="excel_file" class="form-control" accept=".xlsx" required>
                </div>
                <button type="submit" class="btn btn-primary mt-2">–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</button>
            </form>     
            
        </div>

        
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>–°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h1>
        </div>
        
        <table class="table table-bordered">
            <thead class="table-light">
                <tr>
                    <th>–õ–æ–≥–∏–Ω</th>  
                    <th>–§–∞–º–∏–ª–∏—è</th>
                    <th>–ò–º—è</th>
                    <th>–ì—Ä—É–ø–ø–∞</th>
                    <th>–ì–æ–¥</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for student in students %}
                    {% for group in student.groups.all %}
                        <tr>
                            {% if forloop.first %}
                                <td rowspan="{{ student.groups.count }}" class="align-middle">{{ student.username }}</td>
                                <td rowspan="{{ student.groups.count }}" class="align-middle">{{ student.last_name }}</td>
                                <td rowspan="{{ student.groups.count }}" class="align-middle">{{ student.first_name }}</td>
                            {% endif %}
                            <td>{{ group.number }}</td>
                            <td>{{ group.year }}</td>
                            <td>
                                <a href="{% url 'users:delete_student' student.id %}">üóëÔ∏è</a>
                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td>{{ student.username }}</td>
                            <td>{{ student.last_name }}</td>
                            <td>{{ student.first_name }}</td>
                            <td colspan="2" class="text-muted text-center">–ù–µ—Ç –≥—Ä—É–ø–ø—ã</td>
                        </tr>
                    {% endfor %}
                {% endfor %}
            </tbody>
        </table>
    
        <div class="d-flex justify-content-center mt-5">
            <a href="{% url 'users:create_student' %}" class="btn btn-primary ms-5">–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞</a>    
        </div>
    
    </div>
{% endblock %}

